---
title: "Team_Essay_3"
author: "Sahil, Ariel, Ilya, Lekha, Anthony, Trang"
date: "3/18/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

## Formula and Basics

## Loading required R packages

```{r}
library("readxl")
library("tidyverse")
library("flexplot")
library("caret")
```


## Data description

Examples of data and problem: 

- Name: represents name of passenger
- PClass: represents the passenger class (1st, 2nd, 3rd)
- Age: represents age of the passenger in years (N/A if unknown)
- Sex: represents the sex of the passenger in terms of Male/Female
- Survived: represents survival status of passenger in terms of survived(1)/didn't survive(0)
```{r}
titanic <- read_excel("Titanic.xlsx")
titanic <- titanic[1:1313,]
index <- titanic$Age != "NA"
titanic <- titanic[index, ]
titanic$PClass = as.factor(titanic$PClass)
titanic$Sex = as.factor(titanic$Sex)
titanic$Survived = as.factor(titanic$Survived)
titanic$Age = as.factor(titanic$Age)
str(titanic)
```


## Visualization

This the bi-variate dependency result.

```{r}
a = flexplot(Name~1, data = titanic)
b = flexplot(PClass~1, data = titanic)
c = flexplot(Age~1, data = titanic)
d = flexplot(Sex~1, data = titanic)
e = flexplot(Survived~1, data = titanic)
require(cowplot)
plot_grid(a, b, c, d, e, nrow=2)
```


## Analysis

Let us look at the multivariate dependency result.

```{r}
f = flexplot(Survived~Sex | Age + PClass, data = titanic, method="Binomial", se=F, jitter=c(0, 0.2)) 
plot_grid(f)
```


```{r}
f = plot(x = titanic$Age, y = titanic$Survived)
g = flexplot(Survived~Sex, data = titanic, method="Binomial", se=F, jitter=c(0, 0.2))
h = flexplot(Survived~PClass, data = titanic, method="Binomial", se=F, jitter=c(0, 0.2))
plot_grid(f, g, h)
```


## Computation
```{r}
model_1 <- glm(Survived~ PClass + Sex, data=titanic, family=binomial)

summary(model_1)
summary(model_1$fitted.values)
anova(model_1)

model_1_pred <- predict(model_1, type = "response")
u <- union(model_1_pred, titanic$Survived)
t <- table(factor(model_1_pred, u), factor(titanic$Survived, u))
print(t)
```


## Interpretation

## Model evaluation

## Regression line

## Model assessment

## Model summary

## Coefficients significance Prediction and Model accuracy

## Conclusion 

## Summary

## Reference
